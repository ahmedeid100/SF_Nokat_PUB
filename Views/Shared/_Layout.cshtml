<!DOCTYPE html>
<html>
<head title="My Nokat">
    <script src="@Url.Content("~/Scripts/jquery-1.7.2.min.js")" type="text/javascript"></script>
    <link href="@Url.Content("~/Content/Site.css")" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.1/jquery.min.js"></script>
    <script type="text/javascript" src="~/Scripts/quickpager.jquery.js"></script>
    <script type="text/javascript">

/* <![CDATA[ */

$(document).ready(function() {
	$(".pageme tbody").quickPager( {
		pageSize: 10,
		currentPage: 1,
		pagerLocation: "both"
	});
});

/* ]]> */
    </script>
    <style type="text/css">
        p
        {
            background: #e5e5e5;
            margin-bottom: 1px;
            margin-top: 0px;
        }
        
        ul.paging li
        {
            padding: 10px;
            background: #83bd63;
            font-family: georgia;
            font-size: 24px;
            color: #fff;
            line-height: 1;
            width: 180px;
            margin-bottom: 1px;
        }
        
        ul.pageNav li
        {
            display: block;
            padding: 3px;
            font-family: georgia;
        }
        
        ul.pageNav li a
        {
            color: #333;
            text-decoration: none;
        }
        
        li.currentPage
        {
            background: red;
            background: #83bd63;
        }
        
        ul.pageNav li.currentPage a
        {
            color: #fff;
        }
        
        table.pageme
        {
            border-collapse: collapse;
            border: 0px solid #ccc;
        }
        
        table.pageme td
        {
            border-collapse: collapse;
            border: 0px solid #ccc;
        }
        
        table, div
        {
            clear: both;
        }
    </style>
</head>
<body>
    <table >
        <tr>
            <td>
                <img alt="My Nokat" src="../../Content/images/sf-logo-apps.png" />
            </td>
            <td>
            </td>
            <td>
               
        @*<input type="submit" id="inviteFriends" value="Invite Friends" onclick="invite();"/>*@
        <input type="button" onclick="sendRequestViaMultiFriendSelector(); return false;"
            value="Invite Friends" />

            </td>
        </tr>
        <tr>
            <td>
            </td>
            <td>
                <h1>
                    My Nokats</h1>
            </td>
            <td>
                <img alt="My Nokat" width="" src="../../Content/images/logo.jpg" />
            </td>
        </tr>
    </table>

    <div id="MainContent">
    </div>
    <div id="fb-root">
        @* <div class="fb-login-button" data-show-faces="true" data-width="400" data-max-rows="1">
        </div>*@
    </div>
    @Html.Hidden("FBID", "")
    @Html.Hidden("Name", "")
    @Html.Hidden("access_token", "")
    @Html.Hidden("memberID", "")
    <script type="text/javascript" language="javascript">
        window.fbAsyncInit = function () {
            FB.init({
                appId: '323528921058969', // App ID
                channelUrl: 'http://mynokat-1.apphb.com/channel.html', // Channel File
                status: true, // check login status
                cookie: true, // enable cookies to allow the server to access the session
                xfbml: true  // parse XFBML
                //frictionlessRequests: true
            });

            // Additional initialization code here

            FB.Event.subscribe('auth.login', function (response) {
                login();
            });

            login();

        };

        // Load the SDK Asynchronously
        (function (d) {
            var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
            if (d.getElementById(id)) { return; }
            js = d.createElement('script'); js.id = id; js.async = true;
            js.src = "//connect.facebook.net/en_US/all.js";
            ref.parentNode.insertBefore(js, ref);
        } (document));


        function login() {
            FB.login(function (response) {
                if (response.authResponse) {
                    FB.api('/me', function (response1) {
                        $("#FBID").val(response1.id);
                        $("#Name").val(response1.name);
                        $("#access_token").val(response.authResponse.accessToken);

                        var fbid = $("#FBID").val();
                        var name = $("#Name").val();
                        //alert(fbid);
                        $.post("/Joke/AddMember", { FBID: fbid, Name: name }, function (data) {
                            $("#memberID").val(data); //alert(data);
                        });
                    });

                } else {
                    //console.log('User cancelled login or did not fully authorize.');
                }

            });
        }


        function sendRequestViaMultiFriendSelector() {
            FB.ui({ method: 'apprequests',
                message: 'My Nokat Invitation'
            }, function (responce) { });
        }

    </script>
    @RenderBody()
</body>
</html>
