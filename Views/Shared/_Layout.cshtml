<!DOCTYPE html>
<html>
<head>
    <script src="@Url.Content("~/Scripts/jquery-1.7.2.min.js")" type="text/javascript"></script>
    <link href="@Url.Content("~/Content/Site.css")" rel="stylesheet" type="text/css" />
</head>
<body>


    <div>
        <img src="../../Content/images/logo.jpg" />
    </div>
    <div id="MainContent">
    </div>
    <div id="fb-root">
        <div class="fb-login-button" data-show-faces="true" data-width="400" data-max-rows="1">
        </div>
    </div>


    @Html.Hidden("FBID", "")
    @Html.Hidden("Name", "")
    @Html.Hidden("access_token", "")

    
    <script type="text/javascript" language="javascript">
    window.fbAsyncInit = function () {
        FB.init({
            appId: '323528921058969', // App ID
            channelUrl: 'http://mynokat-1.apphb.com/channel.html', // Channel File
            status: true, // check login status
            cookie: true, // enable cookies to allow the server to access the session
            xfbml: true  // parse XFBML
        });

        // Additional initialization code here

        FB.Event.subscribe('auth.login', function (response) {
            login();
        });



    };

    // Load the SDK Asynchronously
    (function (d) {
        var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
        if (d.getElementById(id)) { return; }
        js = d.createElement('script'); js.id = id; js.async = true;
        js.src = "//connect.facebook.net/en_US/all.js";
        ref.parentNode.insertBefore(js, ref);
    } (document));


    function login() {
        FB.login(function (response) {
            if (response.authResponse) {
                FB.api('/me', function (response) {
                    $("#FBID").value = response.name;
                    $("#Name").value = response.uid;
                    $("#access_token").value = response.authResponse.access_token;
                    alert('hi ' + response.name);
                });
            } else {
                //console.log('User cancelled login or did not fully authorize.');
            }
        });
    }
    </script>


    @RenderBody()

</body>
</html>
